name: Build gRPC x86_64/arm64 Universal Library
agent:
  type: Unity::VM::osx
  image: desktop/unity-macos-10.15-xcode-12.2:stable
  flavor: b1.medium
commands:
  - |
    HOMEBREW_NO_AUTO_UPDATE=1 brew install autoconf libtool go
    brew install --cask cmake
    brew install --cask dotnet
    git submodule update --init
    ./unity/build_grpc_mac.sh mac arm64 x86_64
artifacts:
  libraries:
    paths:
      - "artifacts/**"
